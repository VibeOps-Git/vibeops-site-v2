<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="VibeOps â€” AI-powered automation, engineering, and web solutions for startups, businesses, and niche projects." />
    <meta name="keywords" content="AI automation, workflow optimization, web development, engineering consulting, CRM integration" />
    <meta name="author" content="VibeOps" />
    <title>VibeOps â€” {% block title %}{% endblock %}</title>
    <link rel="stylesheet" href="/static/styles.css" />
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico" />
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    {% block extra_head %}{% endblock %}
</head>
<body>
    <header>
        <nav class="nav-container">
            <a href="/" class="nav-logo-link">
                <img src="/static/Logo-wht.png" alt="VibeOps Logo" class="nav-logo">
            </a>
            <button class="nav-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </button>
            <ul class="nav-menu">
                <li><a href="/">Home</a></li>
                <li><a href="/about">About</a></li>
                <li><a href="/services">Services</a></li>
                <li><a href="/team">Team</a></li>
                <li><a href="/pipeline-estimator">Pipeline Estimator</a></li>
                <li><a href="/construction-tracker">Construction Tracker</a></li>
                <li><a href="/struct-wise">Struct-wise</a></li>
                {% if session.google_id %}
                <li><a href="/logout">Logout</a></li>
                {% else %}
                <li><a href="/login">Login</a></li>
                {% endif %}
                <li><a href="/booking" class="btn primary">Book Now</a></li>
            </ul>
        </nav>
    </header>

    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Chatbot Widget -->
    <div class="chatbot-container">
        <button class="chatbot-toggle" aria-label="Toggle chatbot">
            <span class="chatbot-icon">ðŸ’¬</span>
        </button>
        <div class="chatbot-window">
            <div class="chatbot-header">
                <h3>VibeOps: President</h3>
                <button class="chatbot-close" aria-label="Close chatbot">âœ–</button>
            </div>
            <div class="chatbot-messages" id="chatbot-messages">
                <div class="message bot-message">
                    Hey there! I'm President, your VibeOps AI. What's the vibe todayâ€”need a workflow fix or a slick site?
                </div>
            </div>
            <div class="chatbot-input">
                <input type="text" id="chatbot-input" placeholder="Type your message..." aria-label="Chat input">
                <button id="chatbot-send" aria-label="Send message">âž¤</button>
            </div>
        </div>
    </div>

    <footer class="footer" data-aos="fade-in" data-aos-duration="1000">
        <img src="/static/Logo-wht.png" alt="VibeOps Footer Logo" class="footer-logo" data-aos="fade-up" data-aos-delay="100">
        <p data-aos="fade-up" data-aos-delay="200">Â© 2025 VibeOps â€” AI Automation & Web Solutions. All rights reserved.</p>
        <div class="socials" data-aos="fade-up" data-aos-delay="300">
            <a href="mailto:vibeops.info@gmail.com?subject=Let's%20Vibe&body=Hey%20VibeOps%2C%0A%0AI've%20got%20a%20project%20in%20mind:%20[details].%20Let's%20connect!%0A%0A[Your%20Name]">Email: vibeops.info@gmail.com</a>
        </div>
    </footer>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init({
            duration: 800,
            easing: 'ease-out-back',
            once: true,
            mirror: false,
            offset: 100
        });

        // Mobile nav toggle
        const navToggle = document.querySelector('.nav-toggle');
        const navMenu = document.querySelector('.nav-menu');
        navToggle.addEventListener('click', () => {
            navMenu.classList.toggle('active');
            navToggle.setAttribute('aria-expanded', navMenu.classList.contains('active'));
        });

        // Chatbot functionality
        const chatbotToggle = document.querySelector('.chatbot-toggle');
        const chatbotWindow = document.querySelector('.chatbot-window');
        const chatbotClose = document.querySelector('.chatbot-close');
        const chatbotMessages = document.getElementById('chatbot-messages');
        const chatbotInput = document.getElementById('chatbot-input');
        const chatbotSend = document.getElementById('chatbot-send');

        // Toggle chatbot window
        chatbotToggle.addEventListener('click', () => {
            chatbotWindow.classList.toggle('active');
            const isActive = chatbotWindow.classList.contains('active');
            chatbotToggle.setAttribute('aria-expanded', isActive);
            // Store state in sessionStorage
            sessionStorage.setItem('chatOpen', isActive);
        });

        chatbotClose.addEventListener('click', () => {
            chatbotWindow.classList.remove('active');
            chatbotToggle.setAttribute('aria-expanded', 'false');
            // Update sessionStorage
            sessionStorage.setItem('chatOpen', 'false');
        });

        // Load chat history when page loads
        document.addEventListener('DOMContentLoaded', function() {
            fetch('/get-chat-history')
                .then(response => response.json())
                .then(messages => {
                    // Clear initial welcome message
                    chatbotMessages.innerHTML = '';
                    
                    // Add all messages from history
                    messages.forEach(msg => {
                        const messageDiv = document.createElement('div');
                        messageDiv.classList.add('message');
                        messageDiv.classList.add(msg.role === 'user' ? 'user-message' : 'bot-message');
                        messageDiv.textContent = msg.content;
                        chatbotMessages.appendChild(messageDiv);
                    });
                    
                    // Scroll to bottom
                    chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
                })
                .catch(error => console.error('Error loading chat history:', error));

            // Check if chat was open in previous page
            const wasChatOpen = sessionStorage.getItem('chatOpen') === 'true';
            if (wasChatOpen) {
                const chatbotWindow = document.querySelector('.chatbot-window');
                const chatbotToggle = document.querySelector('.chatbot-toggle');
                chatbotWindow.classList.add('active');
                chatbotToggle.setAttribute('aria-expanded', 'true');
            }
        });

        // Update the sendMessage function to store messages in the UI
        function sendMessage() {
            const message = chatbotInput.value.trim();
            if (!message) return;

            // Add user message to chat
            const userMessage = document.createElement('div');
            userMessage.classList.add('message', 'user-message');
            userMessage.textContent = message;
            chatbotMessages.appendChild(userMessage);

            // Clear input
            chatbotInput.value = '';
            chatbotMessages.scrollTop = chatbotMessages.scrollHeight;

            // Show loading message
            const loadingMessage = document.createElement('div');
            loadingMessage.classList.add('message', 'bot-message');
            loadingMessage.textContent = 'President is thinking...';
            chatbotMessages.appendChild(loadingMessage);

            // Call the Flask endpoint to interact with chatbot
            fetch('/chatbot', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ message }),
            })
            .then(response => {
                if (!response.ok) {
                    return response.json().then(data => {
                        throw new Error(data.error || 'Something went wrong');
                    });
                }
                return response.json();
            })
            .then(data => {
                // Remove loading message
                loadingMessage.remove();

                // Add bot response
                const botMessage = document.createElement('div');
                botMessage.classList.add('message', 'bot-message');
                botMessage.textContent = data.response || "Something broke. Let's try that again.";
                chatbotMessages.appendChild(botMessage);
                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
            })
            .catch(error => {
                console.error('Error:', error);
                loadingMessage.remove();
                const errorMessage = document.createElement('div');
                errorMessage.classList.add('message', 'bot-message');
                errorMessage.textContent = error.message || 'Oops, something broke. Try again?';
                chatbotMessages.appendChild(errorMessage);
                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
            });
        }

        chatbotSend.addEventListener('click', sendMessage);
        chatbotInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
    </script>
    {% block extra_scripts %}{% endblock %}
</body>
</html>

<!-- Updated styles.css -->
<style>
/* Reset & Base Styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', sans-serif;
    background: #0e0e0e;
    color: #f2f2f2;
    line-height: 1.6;
    overflow-x: hidden;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* Typography */
h1, h2, h3 {
    font-family: 'Orbitron', sans-serif;
    margin-bottom: 20px;
}

h1 {
    font-size: clamp(2.5rem, 5vw, 4rem);
    line-height: 1.1;
    text-shadow: 0 0 15px rgba(0, 255, 204, 0.5);
}

h2 {
    font-size: clamp(2rem, 4vw, 2.8rem);
}

h3 {
    font-size: clamp(1.5rem, 3vw, 1.8rem);
}

p {
    font-size: clamp(1rem, 2vw, 1.3rem);
    margin: 20px 0;
}

/* Layout */
section {
    padding: 80px 20px;
    text-align: center;
    min-height: 60vh;
}

main {
    margin-bottom: 80px;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

/* Navigation */
header {
    background: #111;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
}

.nav-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.nav-logo-link {
    display: flex;
    align-items: center;
}

.nav-logo {
    max-width: 150px;
}

.nav-menu {
    display: flex;
    gap: 20px;
    list-style: none;
    margin: 0;
    padding: 0;
}

.nav-menu li {
    display: flex;
    align-items: center;
}

.nav-menu a {
    color: #f2f2f2;
    text-decoration: none;
    font-weight: 700;
    transition: color 0.3s ease;
}

.nav-menu a:hover {
    color: #00ffcc;
}

.nav-toggle {
    display: none;
    background: none;
    border: none;
    cursor: pointer;
    padding: 10px;
}

.hamburger {
    display: block;
    width: 25px;
    height: 3px;
    background: #f2f2f2;
    position: relative;
}

.hamburger::before,
.hamburger::after {
    content: '';
    position: absolute;
    width: 25px;
    height: 3px;
    background: #f2f2f2;
    left: 0;
    transition: all 0.3s ease;
}

.hamburger::before {
    top: -8px;
}

.hamburger::after {
    top: 8px;
}

/* Hero Section */
.hero {
    background: radial-gradient(circle at center, #8e2de2 0%, #4a00e0 70%, #0e0e0e 100%);
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
}

.hero-content {
    max-width: 900px;
    padding: 20px;
}

.hero span {
    color: #00ffcc;
    font-style: italic;
}

.cta-buttons {
    display: flex;
    justify-content: center;
    gap: 20px;
    flex-wrap: wrap;
}

/* Buttons */
.btn {
    display: inline-block;
    padding: 14px 32px;
    margin: 10px;
    text-decoration: none;
    border-radius: 8px;
    font-weight: 700;
    transition: all 0.3s ease;
}

.btn.primary {
    background: #00ffcc;
    color: #0e0e0e;
}

.btn.primary:hover {
    animation: pulse 1.5s infinite;
}

.btn.secondary {
    border: 2px solid #00ffcc;
    color: #00ffcc;
}

.btn:hover {
    transform: scale(1.1);
    box-shadow: 0 0 20px rgba(0, 255, 204, 0.7);
    animation: wiggle 0.3s ease;
}

/* Grid & Cards */
.grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 30px;
    margin-top: 40px;
}

.card {
    background: #1e1e1e;
    border: 1px solid #444;
    border-radius: 12px;
    padding: 30px;
    transition: all 0.3s ease;
}

.card:hover {
    transform: translateY(-10px) rotate(1deg);
    box-shadow: 0 15px 35px rgba(0, 255, 204, 0.3);
    border-image: linear-gradient(to right, #8e2de2, #00ffcc) 1;
}

.card .price {
    font-size: 1.5rem;
    color: #00ffcc;
    font-weight: 700;
    margin: 10px 0;
}

/* Services */
.services span {
    color: #00ffcc;
}

.custom-plan {
    margin-top: 40px;
}

.custom-plan h3 {
    color: #00ffcc;
}

/* Pricing */
.pricing {
    background: #0e0e0e;
}

/* Testimonials */
.testimonials {
    background: #111;
}

.testimonials .grid {
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
}

blockquote {
    font-style: italic;
    margin: 20px 0;
    padding: 25px;
    background: #1e1e1e;
    border-left: 4px solid #00ffcc;
}

cite {
    display: block;
    margin-top: 10px;
    font-size: 0.9rem;
    color: #ccc;
}

/* Why Us */
.why-us {
    background: #0e0e0e;
}

/* CTA */
.cta {
    background: #111;
}

.cta span {
    color: #00ffcc;
}

/* Contact */
.contact {
    background: #0e0e0e;
}

/* Calendly Integration */
.calendly-wrapper {
    max-width: 800px;
    margin: 40px auto;
    background: #1e1e1e;
    border-radius: 12px;
    padding: 20px;
    border: 1px solid #444;
}

.calendly-inline-widget {
    border-radius: 8px;
    width: 100%;
}

/* Footer */
.footer {
    background: #111;
    padding: 50px 20px;
    color: #ccc;
}

.footer-logo {
    max-width: 150px;
    margin-bottom: 20px;
}

.socials {
    display: flex;
    justify-content: center;
    gap: 15px;
    flex-wrap: wrap;
}

.socials a {
    color: #00ffcc;
    text-decoration: none;
    transition: all 0.3s ease;
}

.socials a:hover {
    text-decoration: underline;
    color: #fff;
}

/* Chatbot Styles */
.chatbot-container {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 1000;
}

.chatbot-toggle {
    background: #00ffcc;
    color: #0e0e0e;
    border: none;
    border-radius: 50%;
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(0, 255, 204, 0.5);
    transition: transform 0.3s ease;
}

.chatbot-toggle:hover {
    transform: scale(1.1);
    box-shadow: 0 0 15px rgba(0, 255, 204, 0.7);
}

.chatbot-window {
    display: none;
    width: 350px;
    height: 500px;
    background: #1e1e1e;
    border: 1px solid #444;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    flex-direction: column;
    position: absolute;
    bottom: 80px;
    right: 0;
}

.chatbot-window.active {
    display: flex;
}

.chatbot-header {
    background: #111;
    padding: 15px;
    border-top-left-radius: 12px;
    border-top-right-radius: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.chatbot-header h3 {
    font-size: 1.2rem;
    color: #00ffcc;
}

.chatbot-close {
    background: none;
    border: none;
    color: #f2f2f2;
    font-size: 16px;
    cursor: pointer;
}

.chatbot-messages {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
    border-bottom: 1px solid #444;
}

.message {
    margin-bottom: 15px;
    padding: 10px;
    border-radius: 8px;
    max-width: 80%;
}

.user-message {
    background: #00ffcc;
    color: #0e0e0e;
    margin-left: auto;
    text-align: right;
}

.bot-message {
    background: #2e2e2e;
    color: #f2f2f2;
    margin-right: auto;
}

.chatbot-input {
    display: flex;
    padding: 15px;
    border-top: 1px solid #444;
}

.chatbot-input input {
    flex: 1;
    padding: 10px;
    background: #2e2e2e;
    border: 1px solid #444;
    border-radius: 8px 0 0 8px;
    color: #f2f2f2;
    font-size: 1rem;
}

.chatbot-input button {
    background: #00ffcc;
    color: #0e0e0e;
    border: none;
    padding: 10px 15px;
    border-radius: 0 8px 8px 0;
    cursor: pointer;
    font-size: 1rem;
    transition: background 0.3s ease;
}

.chatbot-input button:hover {
    background: #00ccaa;
}

/* Animations */
@keyframes wiggle {
    0%, 100% { transform: rotate(0deg); }
    25% { transform: rotate(-2deg); }
    75% { transform: rotate(2deg); }
}

@keyframes pulse {
    0% { box-shadow: 0 0 0 0 rgba(0, 255, 204, 0.7); }
    70% { box-shadow: 0 0 0 10px rgba(0, 255, 204, 0); }
    100% { box-shadow: 0 0 0 0 rgba(0, 255, 204, 0); }
}

/* Responsive Design */
@media (max-width: 1024px) {
    .grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }

    .card {
        padding: 20px;
    }

    .testimonials .grid {
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }
}

@media (max-width: 768px) {
    h1 { font-size: 2.5rem; }
    h2 { font-size: 2rem; }
    h3 { font-size: 1.5rem; }
    p { font-size: 1rem; }

    .nav-toggle {
        display: block;
    }

    .nav-menu {
        display: none;
        position: absolute;
        top: 70px;
        left: 0;
        right: 0;
        background: #111;
        flex-direction: column;
        padding: 20px;
        gap: 15px;
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.5);
    }

    .nav-menu.active {
        display: flex;
        margin-top: 50px;
    }

    .nav-menu li {
        justify-content: center;
    }

    .nav-menu a {
        font-size: 1.2rem;
    }

    .grid {
        grid-template-columns: 1fr;
    }

    .card .price {
        font-size: 1.2rem;
    }

    .calendly-wrapper {
        padding: 15px;
    }

    .chatbot-window {
        width: 300px;
        height: 400px;
    }
}

@media (max-width: 480px) {
    section {
        padding: 60px 15px;
    }

    .btn {
        padding: 12px 24px;
        font-size: 0.9rem;
    }

    .nav-logo {
        max-width: 120px;
    }

    .footer {
        padding: 40px 15px;
    }

    .socials {
        flex-direction: column;
        gap: 10px;
    }

    .chatbot-window {
        width: 280px;
        height: 350px;
    }

    .chatbot-toggle {
        width: 50px;
        height: 50px;
        font-size: 20px;
    }
}

/* â”€â”€â”€ VIDEO BOX â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.video-box {
    background: #1e1e1e;
    padding: 16px;
    border-radius: 12px;
    max-width: 900px;
    margin: 40px auto;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
    position: relative;
    overflow: hidden;
}

.video-box iframe {
    position: relative;
    width: 100%;
    aspect-ratio: 16 / 9;
    height: auto;
    border: none;
    border-radius: 6px;
    display: block;
}

/* â”€â”€â”€ HAMBURGER / MOBILE NAV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.nav-toggle {
    display: none;
    background: none;
    border: none;
    cursor: pointer;
    padding: 10px;
    z-index: 200;
}

.hamburger,
.hamburger::before,
.hamburger::after {
    content: '';
    display: block;
    width: 25px;
    height: 3px;
    background: #f2f2f2;
    border-radius: 2px;
    position: relative;
    transition: all 0.3s ease;
}

.hamburger::before {
    top: -8px;
}

.hamburger::after {
    top: 5px;
}

.nav-toggle.active .hamburger {
    background: transparent;
}

.nav-toggle.active .hamburger::before {
    transform: translateY(8px) rotate(45deg);
}

.nav-toggle.active .hamburger::after {
    transform: translateY(-5px) rotate(-45deg);
}

/* â”€â”€â”€ MOBILE LAYOUT ADJUSTMENTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media (max-width: 768px) {
    header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
    }

    main {
        padding-top: 70px;
    }

    .nav-toggle {
        display: block;
    }

    .nav-menu {
        position: fixed;
        top: 60px;
        left: 0;
        right: 0;
        background: #111;
        flex-direction: column;
        gap: 20px;
        padding: 30px 20px;
        align-items: center;
        display: flex;
        transform: translateY(-100%);
        opacity: 0;
        pointer-events: none;
        transition: transform 0.3s ease, opacity 0.3s ease;
        z-index: 150;
    }

    .nav-menu.active {
        transform: translateY(0);
        opacity: 1;
        pointer-events: auto;
    }

    .nav-menu li {
        width: 100%;
        text-align: center;
    }

    .nav-menu a {
        display: block;
        width: 100%;
        padding: 15px 0;
        font-size: 1.2rem;
    }
}
</style>